source_table,source_column,target_table,target_column,transformation_logic,data_type,is_categorical,categories
staging_db.customer,customer_id,final_db.customer_summary,customer_id,Direct mapping,bigint,False,
staging_db.account,account_id,final_db.customer_summary,total_accounts,COUNT(DISTINCT n.account_id),bigint,False,
staging_db.account,account_type,final_db.customer_summary,account_type,Direct mapping,string,True,"SAVINGS, CHECKING, CREDIT_CARD, LOAN"
staging_db.transaction,amount,final_db.customer_summary,total_debit,SUM(CASE WHEN u.txn_type = 'DEBIT' THEN u.amount ELSE 0 END),"decimal(18,2)",False,
staging_db.transaction,amount,final_db.customer_summary,total_credit,SUM(CASE WHEN u.txn_type = 'CREDIT' THEN u.amount ELSE 0 END),"decimal(18,2)",False,
staging_db.transaction,txn_date,final_db.customer_summary,last_txn_date,MAX(n.last_txn_date),date,False,
core_db.segmentation_rules,segment_name,final_db.customer_summary,segment_name,Direct mapping,string,True,"BRONZE, SILVER, GOLD, PLATINUM, UNKNOWN"
core_db.customer_region,region,final_db.customer_summary,region,"coalesce(r.region, 'UNKNOWN')",string,True,"NORTHEAST, MIDWEST, SOUTH, WEST, UNKNOWN"
core_db.risk_assessment,risk_score,final_db.customer_summary,risk_score,AVG(score),,False,
